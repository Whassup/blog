(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var s,r,o,i,c,a,l=n(1),d=n(22),u=n(11),h=n(5),b=n(3),j=n(4),p=n(0),m=j.a.header(s||(s=Object(b.a)(["\n    display: flex;\n    flex-direction: column;\n    padding: 4rem 2rem;\n    align-items: center;\n"]))),g=j.a.h1(r||(r=Object(b.a)(["\n    font-size: 3.5rem;\n    margin-bottom: 4rem;\n"]))),O=j.a.strong(o||(o=Object(b.a)(["\n    color: #000;\n    font-weight: 700;\n"]))),f=j.a.nav(i||(i=Object(b.a)(["\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n"]))),x=Object(j.a)(u.b)(c||(c=Object(b.a)(["\n    text-decoration: none;\n    text-transform: uppercase;\n    color: #95a1b1;\n"]))),w=function(){return Object(p.jsxs)(m,{children:[Object(p.jsxs)(g,{children:['() => "',Object(p.jsx)(O,{children:"Robert Prib"}),'"']}),Object(p.jsx)(f,{children:Object(p.jsx)(x,{to:"/blog",children:"Home"})})]})},y=n(18),v=["title","titleId"];function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function H(e,t){var n=e.title,s=e.titleId,r=C(e,v);return l.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":s},r),n?l.createElement("title",{id:s},n):null,a||(a=l.createElement("path",{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm64-192c0-8.8 7.2-16 16-16h96c8.8 0 16 7.2 16 16v96c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16v-96zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"})))}var E,I=l.forwardRef(H),S=(n.p,["title","titleId"]);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function B(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T(e,t){var n=e.title,s=e.titleId,r=B(e,S);return l.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":s},r),n?l.createElement("title",{id:s},n):null,E||(E=l.createElement("path",{d:"M432 304c0 114.9-93.1 208-208 208S16 418.9 16 304c0-104 76.3-190.2 176-205.5V64h-28c-6.6 0-12-5.4-12-12V12c0-6.6 5.4-12 12-12h120c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-28v34.5c37.5 5.8 71.7 21.6 99.7 44.6l27.5-27.5c4.7-4.7 12.3-4.7 17 0l28.3 28.3c4.7 4.7 4.7 12.3 0 17l-29.4 29.4-.6.6C419.7 223.3 432 262.2 432 304zm-176 36V188.5c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12V340c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12z"})))}var D,R,U,A,L,W,V,P,G,F,q,z,M=l.forwardRef(T),_=(n.p,n(92)),J=n(41),Y=n(91);_.a.registerLanguage("jsx",J.a);var K,Q,X,Z,$,ee=j.a.h1(D||(D=Object(b.a)(["\n    font-size: 2.5rem;\n    font-weight: 700;\n    margin-bottom: 1.5rem;\n\n    > * {\n        color: #000;\n    }\n"]))),te=j.a.h2(R||(R=Object(b.a)(["\n    font-size: 2rem;\n    font-weight: 700;\n    margin-bottom: 1.5rem;\n"]))),ne=j.a.section(U||(U=Object(b.a)(["\n    color: #95a1b1;\n    fill: #95a1b1;\n    display: block;\n    margin-bottom: 1.25rem;\n"]))),se=j.a.p(A||(A=Object(b.a)(["\n    margin-bottom: 1.25rem;\n    margin-top: 0.5rem;\n    text-align: left;\n"]))),re=j.a.ul(L||(L=Object(b.a)(["\n    margin-bottom: 1.5rem;\n    text-align: left;\n"]))),oe=j.a.li(W||(W=Object(b.a)(["\n    margin-bottom: 0.5rem;\n    margin-left: 1.5rem;\n    text-align: left;\n    list-style: disc;\n    list-style-position: inside;\n"]))),ie=j.a.a(V||(V=Object(b.a)(["\n    color: #2379be;\n    text-decoration: underline;\n"]))),ce=j.a.strong(P||(P=Object(b.a)(["\n    font-weight: 400;\n"]))),ae=function(e){var t=e.children;return Object(p.jsx)(_.a,{language:"jsx",style:Y.a,wrapLongLines:!0,codeTagProps:{style:{fontSize:"1rem",maxHeight:"400px",display:"block"}},children:t})},le=j.a.code(G||(G=Object(b.a)(["\n    color: #f55e00;\n    background-color: rgb(253, 246, 227);\n    border-radius: 0.1em;\n    padding: 0.5rem 0.5rem;\n    white-space: nowrap;\n"]))),de=j.a.figure(F||(F=Object(b.a)(["\n    padding-left: 1rem;\n    border-left: 10px solid #35fdbe;\n    font-style: italic;\n    font-size: 1rem;\n    font-weight: 400;\n"]))),ue=j.a.figcaption(q||(q=Object(b.a)(["\n    font-weight: 300;\n"]))),he=function(e){var t=e.children,n=e.source,s=e.cite,r=e.citeLink;return Object(p.jsxs)(de,{children:[Object(p.jsx)("blockquote",{cite:r,children:t}),(n||s)&&Object(p.jsxs)(ue,{children:["\u2014 ",n,s&&Object(p.jsxs)("cite",{children:[","," ",r?Object(p.jsx)(ie,{href:r,target:"_blank",children:s}):{cite:s}]})]})]})},be=j.a.i(z||(z=Object(b.a)(["\n    svg {\n        width: 1rem;\n    }\n"]))),je=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(y.a,{children:[Object(p.jsx)("title",{children:"How our team writes React tests and other stuff too | Robert Prib | Blog "}),Object(p.jsx)("meta",{name:"description",content:"Write React tests that are easy to read, write and reduced wasted time on decisions."}),Object(p.jsx)("meta",{name:"og:title",content:"How our team writes React tests and other stuff too | Robert Prib | Blog "}),Object(p.jsx)("meta",{name:"og:description",content:"Write React tests that are easy to read, write and reduced wasted time on decisions."}),Object(p.jsx)("meta",{name:"og:url",content:"https://whassup.github.io/blog/article/how-our-team-writes-tests"}),Object(p.jsx)("meta",{name:"og:image",content:"https://whassup.github.io/blog/article/how-our-team-writes-tests"})]}),Object(p.jsx)(ee,{children:"How our team writes React tests and other stuff too"}),Object(p.jsxs)(ne,{children:[Object(p.jsxs)("time",{children:[Object(p.jsx)(be,{children:Object(p.jsx)(I,{})})," ","5 June 2021"]})," ",Object(p.jsxs)("span",{children:[Object(p.jsx)(be,{children:Object(p.jsx)(M,{})})," ","8 minute read"]})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(se,{children:"Have you ever worked in a codebase where each test file was different to the next? Different terminology and grouping of test scenarios; different usages of snapshot testing and react-testing-library."}),Object(p.jsx)(se,{children:"The effect of this meant wasted time reading a full test file to understand its structure before adding another test case. Creating new tests involved making multiple decisions; should I copy the structure of an existing test or create a new one? Should I use snapshot tests?"}),Object(p.jsx)(se,{children:"We solved this problem by defining guidelines to follow, that make writing tests that are easy to read and write, and would reduced wasted time on decisions."}),Object(p.jsx)(se,{children:"Our guidelines are as follows:"}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Group tests by render and user behaviours"}),Object(p.jsx)(oe,{children:"Use a snapshot test to validate render"}),Object(p.jsx)(oe,{children:"Use GIVEN-WHEN-THEN to describe branching logic"}),Object(p.jsxs)(oe,{children:["Don't be afraid to stub child components"," ",Object(p.jsx)(ie,{href:"https://ericdcobb.medium.com/advanced-react-component-mocks-with-jest-and-react-testing-library-f1ae8838400b",target:"_blank",children:"also know in Jest as mocking"})]}),Object(p.jsx)(oe,{children:"Don't re-test functionality of other components"}),Object(p.jsxs)(oe,{children:["Use a single ",Object(p.jsx)(le,{children:"expect"})," statement per test"]}),Object(p.jsx)(oe,{children:"Accept unit testing UI components can be difficult"}),Object(p.jsxs)(oe,{children:["Try use ",Object(p.jsx)(le,{children:"screen.getByRole"})]}),Object(p.jsx)(oe,{children:"Isolate complex component logic, and test separately"})]}),Object(p.jsxs)(se,{children:["For each guideline I go into greater detail using this Counter component as an example for our testing purposes:"," "]}),Object(p.jsx)(ae,{children:'const Counter = ({ initialCount, steps }) => {\n    const [{ count, action }, setCount] = useState(initialCount, action: null });\n\n    const increment = () => {\n        setCount(({count }) => { count: count + steps, action: "increment-click" });\n\n    }\n\n    const inputChange = (e) => {\n        setCount(({count }) => { count: e.target.value, action: "input-change" });\n    }\n\n    return (<>\n        <input name="counter" value={count} onChange={inputChange} />\n        <button onClick={increment}>Increment</button>\n        <Tooltip>increments in steps of {steps}</Tooltip>\n    </>\n    );\n};'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Group tests by render and user behaviours"}),Object(p.jsx)(se,{children:"Group tests into describe blocks named render and behaviours at the top level. "}),Object(p.jsx)("p",{children:"The main advantages of grouping the tests is to:"}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Provide clarity to the reviewer/collaborator on where to find or add a specific test case"}),Object(p.jsxs)(oe,{children:["Prompt the initial test author(s) to include tests for the two main scenarios that need testing:",Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Assert on things that appear on render"}),Object(p.jsx)(oe,{children:"Assert on things that change after an user interaction"})]})]})]}),Object(p.jsx)(ae,{children:'describe("<Counter />", () => {\n    describe("render" => () => {\n        // include your tests for things that should happen on render\n    });\n\n    describe("behaviours" => () => {\n        // include your tests for things that should happen after user interactions\n    });\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Use a snapshot test to validate render"}),Object(p.jsxs)(se,{children:["Snapshots are good for validating regressions when refactoring code and capturing changes to shared styled components. However snapshots have drawbacks, as they can:"," "]}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Slow down the test suite"}),Object(p.jsx)(oe,{children:"Slow down the test suite"}),Object(p.jsx)(oe,{children:"Generate errors in multiple components when making a minor change to a single component."})]}),Object(p.jsx)(se,{children:"As such the guidelines for using snapshot tests are as follows:"}),Object(p.jsxs)(re,{children:[Object(p.jsxs)(oe,{children:["Generate at least 1 snapshot test per component on render to:",Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Validate shared styled-component changes that could affect this component."}),Object(p.jsx)(oe,{children:"Validate any regressions when code refactoring."}),Object(p.jsxs)(oe,{children:["Mock child components to reduce time to produce snapshots and to reduce the triggering of errors when making changes to components."," ",Object(p.jsx)(ce,{children:"(See section Don't be afraid to stub child components)."})]})]})]}),Object(p.jsx)(oe,{children:"Consider removing existing snapshots and generating new snapshots when making substantial changes to component functionality"}),Object(p.jsxs)(oe,{children:["When refactoring a component you should use the"," ",Object(p.jsx)(ie,{href:"https://jestjs.io/docs/snapshot-testing#interactive-snapshot-mode",target:"_blank",children:"interactive update snapshot mode"})," ","to update and review any changes to snapshots."]}),Object(p.jsx)(oe,{children:"Closely review changes to snapshots in PRs as so not miss regressions"})]}),Object(p.jsx)(ae,{children:'describe("<Counter />", () => {\n\tdescribe("render" => () => {\n\t\tit("SHOULD render", () => {\n\t\t\tconst { asFragment } = render(<Counter />);\n\t\t\texpect(asFragment()).toMatchSnapshot();\n\t\t});\n\t});\n\n\tdescribe("behaviours" => () => {\n\t\t// include your tests for things that should happen after user interactions*\n\t});\n\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Use GIVEN-WHEN-THEN to describe branching logic"}),Object(p.jsx)(se,{children:"The biggest improvement to our tests readability has been determining a consistent language and structure for our test descriptions \u2013 and for not a lot of effort! We found that using the [GIVEN-WHEN-THEN](https://www.agilealliance.org/glossary/gwt) structure works really well for describing component tests when using the `react-testing-library`."}),Object(p.jsxs)(se,{children:[Object(p.jsx)(ce,{children:"GIVEN"})," some context e.g. some component props, context, or state"]}),Object(p.jsxs)(se,{children:[Object(p.jsx)(ce,{children:"WHEN"})," some action is carried out e.g. a button is clicked or an user types in an input"]}),Object(p.jsxs)(se,{children:[Object(p.jsx)(ce,{children:"THEN"})," a particular set of observable set of consequences ",Object(p.jsx)(ce,{children:"SHOULD"})," ","happen - e.g. some text has changed or no longer displays in the browser."]}),Object(p.jsx)(se,{children:"We use GIVEN-WHEN-THEN in the following manner:"}),Object(p.jsxs)(re,{children:[Object(p.jsxs)(oe,{children:["Write the keywords ",Object(p.jsx)(le,{children:"GIVEN, WHEN, AND, NOT, SHOULD"})," in uppercase to make the structure easy to identify and read."]}),Object(p.jsxs)(oe,{children:["Start with ",Object(p.jsx)(le,{children:"GIVEN before WHEN"})]}),Object(p.jsx)(oe,{children:"Strict adherence is not required to the structure, focus should be placed on readability"})]}),Object(p.jsx)(se,{children:"You will notice the example below creates meaningful sentences that describes each test scenario e.g."}),Object(p.jsxs)(re,{children:[Object(p.jsxs)(oe,{children:[Object(p.jsx)(le,{children:"<Counter />"})," render GIVEN a initial count AND steps great than zero SHOULD display provided count"]}),Object(p.jsxs)(oe,{children:[Object(p.jsx)(le,{children:"<Counter />"})," behaviours WHEN a user clicks increase count button GIVEN steps SHOULD display provided count"]})]}),Object(p.jsx)(ae,{children:'describe("<Counter />", () => {\n    describe("render" => () => {\n        it("SHOULD render", () => {\n                // snapshot test\n        });\n\n        describe("GIVEN NO intial count", () => {\n            describe("AND steps greater than 0", () => {\n                it("SHOULD display count zero", () => {\n                    // ...\n                });\n            });\n        });\n\n        describe("GIVEN a initial count", () => {\n            it("SHOULD display provided count", () => {\n                // ...\n            });\n\n            describe("AND steps greater than 0", () => {\n                it("SHOULD display steps amount", () => {\n                        // ...\n                });\n            });\n\n            describe("AND steps is 0", () => {\n                it("SHOULD NOT display counter", () => {\n                    // ...\n                });\n                it("SHOULD THROW steps must be greater than 0 error", () => {\n                    // ...\n                });\n            });\n        });\n\n    });\n\n    describe("behaviours" => () => {\n\n        describe("WHEN a user clicks increase count button", () => {\n            it("SHOULD display incremented count", () => {\n                    // ...\n            });\n        });\n    \n        describe("WHEN a user clicks increase count button multiple times", () => {\n            it("SHOULD display incremented count", () => {\n                    // ...\n            });\n        });\n\n        describe("GIVEN steps", () => {\n            describe("WHEN a user clicks increase count button", () => {\n                it("SHOULD display incremented count", () => {\n                        // ...\n                });\n            });\n        \n            describe("WHEN a user clicks increase count button multiple times", () => {\n                it("SHOULD display incremented count", () => {\n                        // ...\n                });\n            });\n        });\n\n        describe("GIVEN an initial count", () => {\n            describe("WHEN a user clicks increase count button", () => {\n                it("SHOULD display incremented count", () => {\n                        // ...\n                });\n            });\n        \n            describe("WHEN a user clicks increase count button multiple times", () => {\n                it("SHOULD display incremented count", () => {\n                        // ...\n                });\n            });\n        });\n\n    });\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{}),Object(p.jsx)(he,{source:"Martin Fowler",cite:"Mocks arent Stubs",citeLink:"https://martinfowler.com/articles/mocksArentStubs.html",children:"Stubs provide canned answers to calls made during the test, usually not responding at all to anything outside what's programmed in for the test. Stubs may also record information about calls, such as an email gateway stub that remembers the messages it \u2018sent\u2019, or maybe only how many messages it \u2018sent\u2019."}),Object(p.jsxs)(se,{children:["Stubs are described as Mocks in Jest. See this article"," ",Object(p.jsx)(ie,{href:"https://ericdcobb.medium.com/advanced-react-component-mocks-with-jest-and-react-testing-library-f1ae8838400b",target:"_blank",children:"Advanced React Component Mocks with Jest and React Testing Library"})," ","by Eric Cobb for details about how to use jest to stub components."]}),Object(p.jsx)(se,{children:"These are unit tests and not integration tests. Stubbing out complex components can:"}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"Reduce the amount of effort to write a test"}),Object(p.jsx)(oe,{children:"Increases the speed of snapshot testing"}),Object(p.jsxs)(oe,{children:["Allow you to stub browser behaviours. Not all features of the browser of are emulated in"," ",Object(p.jsx)(ie,{href:"https://github.com/jsdom/jsdom",target:"_blank",children:"jsdom"}),", and in these scenarios it makes more sense to mock the child component or browser behaviour."]})]}),Object(p.jsxs)(se,{children:["For example what if our counter example had a tooltip component within it. Usually tooltip components contain a lot of code and logic for figuring out where to position themselves on the page. Within our counter test, we don't care if the tooltip works \u2013 there should already be coverage in for this in our tooltip tests. In that case why let this component get in the way the counter tests or slow us down?"," "]}),Object(p.jsx)(ae,{children:'// Counter.jsx\n\nimport { Tooltip } from "./tooltip";\n\nconst Counter = ({ initialCount, steps }) => {\n\tconst [count, setCount] = useState(initialCount);\n\tconst increment = () => setCount((count) => count + steps);\n\n\treturn (<>\n\t\t<input name="counter" value={count} />\n\t\t<button onClick={increment}>Increment</button>\n\t\t<Tooltip>increments in steps of {steps}</Tooltip>\n\t</>);\n};\n\n// Counter.spec.jsx\n\njest.mock("./tooltip", () => {\n\tTooltip: ({ children }) => <>{children}</>;\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Don't re-test functionality of child components"}),Object(p.jsx)(se,{children:"Referring back to our previous counter component example, we avoid testing that the tooltip works in the context of the counter component. We expect that the tooltip already has coverage in its own tests, and it usage within the counter component is only considered plumbing or configuration, which can just be validated by a developer, or in a code review."}),Object(p.jsx)(se,{children:"e.g. We do not test the following:"}),Object(p.jsx)(ae,{children:'describe("<Counter />", () => {\n\t\tdescribe("behaviours", () => {\n\t\t\tdescribe("WHEN user mouseovers tooltip", () => {\n\t\t\t\t// AVOID TESTING THIS!\n\t\t\t\tit("SHOULD display tooltip text", () => {\n        });\n      });\n\t\t});\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Use a single expect per test"}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"It's easier to debug failing tests"}),Object(p.jsx)(oe,{children:"The test case is easier to read and understand what it is testing for"})]}),Object(p.jsx)(ae,{children:"describe(\"<Counter />\", () => {\n\tdescribe(\"behaviours\", () => {\n        // AVOID THIS\n\t\tdescribe(\"WHEN user clicks increment\", () => {\n            it(\"SHOULD display incremented value for each click by defined steps\", () => {\n                render(<Counter steps={5} intialCount={0}/>);\n                const incrementButton = screen.getByRole('button', { name: 'increment'});\n                userEvent.click(incrementButton);\n                const counter = screen.getByRole('textarea', { name: 'counter'})\n\n                expect(counter.value).toBe(5);\n\n                userEvent.click(incrementButton);\n                expect(counter.value).toBe(10);\n\n                            userEvent.click(incrementButton);\n                expect(counter.value).toBe(15);\n            });\n        \n        });\n\n        // PREFER THIS\n        describe(\"WHEN user clicks increment\", () => {\n            it(\"SHOULD display incremented value by defined steps\", () => {\n                render(<Counter steps={5} intialCount={0}/>);\n                const incrementButton = screen.getByRole('button', { name: 'increment'});\n                userEvent.click(incrementButton);\n                const counter = screen.getByRole('textarea', { name: 'counter'})\n\n                expect(counter.value).toBe(5);\n            });\n        });\n\n        describe(\"WHEN user clicks increment multiple times\", () => {\n            it(\"SHOULD display incremented value by defined steps times clicks\", () => {\n                render(<Counter steps={5} intialCount={0}/>);\n                const incrementButton = screen.getByRole('button', { name: 'increment'});\n                userEvent.click(incrementButton);\n                const counter = screen.getByRole('textarea', { name: 'counter'})\n                userEvent.click(incrementButton);\n                userEvent.click(incrementButton);\n                userEvent.click(incrementButton);\n\n                expect(counter.value).toBe(15);\n            });\n        });\n    });\n});"})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Accept unit testing UI components can be difficult"}),Object(p.jsxs)(se,{children:["The"," ",Object(p.jsx)(ie,{href:"https://testing-library.com/docs/react-testing-library/intro/",target:"_blank",children:"react-test-library"})," ","is limited by the functionality provided by"," ",Object(p.jsx)(ie,{href:"https://github.com/jsdom/jsdom",target:"_blank",children:"js-dom"})," ","where not all all browser APIs are emulated, making it hard to test. Things usually difficult to test are:"]}),Object(p.jsx)(re,{children:Object(p.jsx)(oe,{children:"User scrolling within areas of the page. e.g. A common example of this is browser scrolling, for example, testing that data is loaded when a user scrolls past a threshold."})}),Object(p.jsx)(se,{children:"When writing a particular test becomes too difficult, we should consider the following:"}),Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"You may be testing for the wrong thing. e.g. Are you testing child components like in the tooltip example above?"}),Object(p.jsx)(oe,{children:"Your component may be doing too much e.g. Is your component handling the retrieving of data from an API, rendering a list and calculating the printing out of pagination? If your component is doing more than 2-3 things you should consider splitting your component out into smaller components or hooks."}),Object(p.jsxs)(oe,{children:["Is there another way you could test this? Could I write a simpler test?",Object(p.jsxs)(re,{children:[Object(p.jsx)(oe,{children:"What would it mean if you didn't have this test and there was an error in this part of the code?"}),Object(p.jsx)(oe,{children:"Is there another way you could test this? e.g Could I write a simpler."}),Object(p.jsxs)(oe,{children:["Is there another way you could test this? Could I write a simpler test?",Object(p.jsx)(ae,{children:'describe("WHEN user scrolls to bottom of page", () => {\n\t// TODO: Figure out how to test this\n\tit.skip("SHOULD load more results") \n});'})]})]})]})]})]}),Object(p.jsxs)("section",{children:[Object(p.jsxs)(te,{children:["Try use ",Object(p.jsx)(le,{children:"getByRole"})]}),Object(p.jsxs)(se,{children:["If you familiarise yourself with the testing libraries documentation on"," ",Object(p.jsx)(ie,{href:"https://testing-library.com/docs/queries/about/#priority",target:"_blank",children:"priority of queries"})," ","you will notice that the first query suggested to utilise is ",Object(p.jsx)(le,{children:"getByRole"}),"."," "]}),Object(p.jsxs)(se,{children:["For the majority of user behaviours, there is a way to use ",Object(p.jsx)(le,{children:"getByRole"}),". to find the element to interact with. The ability to query an element using"," ",Object(p.jsx)(le,{children:"getByRole"}),". means it will very likely be accessible and visible to screen readers."," "]}),Object(p.jsxs)(se,{children:["I recommend reviewing the [MDN docs for ARIA Roles](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles) to figure out the best way to add the correct roles to your interactive elements so that",Object(p.jsx)(le,{children:"getByRole"}),". can be used."]}),Object(p.jsxs)(se,{children:["For example for a ",Object(p.jsx)(le,{children:"button"})," element you can use the attribute"," ",Object(p.jsx)(le,{children:'aria-pressed="true"'})," to represent a button is active or inactive."]}),Object(p.jsxs)(se,{children:["I will use the example of a ",Object(p.jsx)(le,{children:"ToggleButton"})," that can either be on or off to show how we can now test a button's active state using ",Object(p.jsx)(le,{children:"getByRole"}),"."," "]}),Object(p.jsx)(ae,{children:'// ToggleButton.js\nconst ToggleButton = ({intialActive}) => {\n    const [isActive, setActive] = useState(intialActive)\n    return (<button aria-pressed={isActive}>{ isActive? \'On\': \'Off\' }</button>\n}\n\nOnOffSwitch.defaultProps = {\n    intialActive; false\n}\n\n// ToggleButton.spec.js\ndescribe("<ToggleButton />", () => {\n\tdescribe("behaviours", () => {\n     describe("GIVEN button is toggled off", () => {\n        describe("WHEN user clicks toggle button", () => {\n            it("SHOULD set button state inactive", () => {\n                render(<ToggleBtn />)\n                const toggle = screen.getByRole(\'button\', { name: /off/i, pressed: false });\n                userEvent.click(toggle)\n                const activeToggle = screen.getByRole(\'button\', { name: /on/i, pressed: true});\n\n                expect(activeToggle).toBeInTheDocument();\n            });\n        });\n     });\n  });\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Isolate complex component logic into a hooks and helper functions and test separately"}),Object(p.jsx)(se,{children:"In the counter component example, if we wanted to add a feature that allows users to provide their own value using keyboard input, this would require more logic to be added into our component."}),Object(p.jsxs)(se,{children:["Adding more logic will increase the amount of tests and responsibilities for that component. By refactoring some of the logic into a ",Object(p.jsx)(le,{children:"useCounter"})," hook, we can split out the responsibility and make things easier to test."]}),Object(p.jsxs)(se,{children:["The refactored counter component and ",Object(p.jsx)(le,{children:"useCounter"})," hook"]}),Object(p.jsx)(ae,{children:'// useCounter.js\nexport const useCounter = (initialCount, steps) => {\n\n\tconst [count, setCount] = useState(initialCount);\n\t\n\tconst increment = () => {\n\t\tsetCount(({count }) => count + steps);\n\t}\n\n\treturn { count, increment, setCount  }\n}\n\n// Counter.js\nexport const Counter = ({ initialCount, steps }) => {\n\n\tconst { count, increment, setCount } =  useCounter(initialCount, steps );\n\n\treturn (<>\n\t\t<input name="counter" value={count} onChange={(e) => setCount(e.target.value)} />\n\t\t<button onClick={increment}>Increment</button>\n\t\t<Tooltip>increments in steps of {steps}</Tooltip>\n\t</>);\n};'}),Object(p.jsx)(se,{children:"The updated tests"}),Object(p.jsx)(ae,{children:'// useCounter.spec.js\ndescribe("useCounter", () => {\n    describe("GIVEN intialCount AND steps", () => {\n        it("SHOULD set count to intialCount", () => {\n            const { result } = renderHook(() => useCounter({ intialCount: 5, steps: 10 }))\n\n            expect(result.current.count).toBe(5);\n        });\n\n    describe("GIVEN increment()", () => {\n\t    it("SHOULD increase count by steps", () => {\n\t        const { result } = renderHook(() => useCounter({ intialCount: 5, steps: 10 }))\n            act(() => {\n            result.current.increment()\n            })\n            expect(result.current.count).toBe(15);\n        });\n    });\n\n    describe("GIVEN setCount() with new value", () =>{\n        it("SHOULD update count value", () => {\n            const { result } = renderHook(() => useCounter({ intialCount: 5, steps: 10 }))\n            act(() => {\n            result.current.setCount(20)\n            })\n            expect(result.current.count).toBe(20);\n        });\n\t});\n});\n\n// Counter.spec.js\ndescribe("<Counter />", () => {\n\n    describe("render" => () => {\n        it("SHOULD render", () => {\n            const { asFragment } =  render(<Counter />);\n\n            expect(asFragment()).toMatchSnapshot();\n        });\n    });\n});'})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)(te,{children:"Conclusion"}),Object(p.jsx)(se,{children:"After following these guidelines we went from having a haphazard approach to writing and structuring UI tests, to having a clear and consistent method. There are many different ways to write, structure, and organise tests, and this is by no means the best or only approach, but one that worked for us."}),Object(p.jsxs)(se,{children:["If you want to improve testing in your codebase you should consider agreeing on a set of guidelines that suits your team."," "]})]})]})},pe=j.a.article(K||(K=Object(b.a)(["\n    padding: 2rem 25%;\n    background-color: #f7fff6;\n    /* padding: 2rem 4rem; */\n    border-radius: 1rem;\n"]))),me=function(e){var t=e.pageIdentifier;return Object(l.useEffect)((function(){document.querySelectorAll("link[href*=disqus]").forEach((function(e){return e.remove()})),window.disqus_config=function(){this.page.url=window.location.href,this.page.identifier=t};var e=document,n=e.createElement("script");return n.src="https://robert-prib-blog.disqus.com/embed.js",n.setAttribute("data-timestamp",(+new Date).toString()),(e.head||e.body).appendChild(n),function(){n.remove()}}),[t]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{id:"disqus_thread"}),Object(p.jsxs)("noscript",{children:["Please enable JavaScript to view the"," ",Object(p.jsx)("a",{href:"https://disqus.com/?ref_noscript",children:"comments powered by Disqus."})]})]})},ge=function(){var e=Object(h.f)().article;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(w,{}),Object(p.jsxs)(pe,{children:[Object(p.jsx)(je,{}),Object(p.jsx)(me,{pageIdentifier:e})]})]})},Oe=j.a.article(Q||(Q=Object(b.a)(["\n    display: flex;\n    flex-direction: column;\n    gap: 3rem;\n    padding: 0 15%;\n"]))),fe=j.a.article(X||(X=Object(b.a)(["\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n    align-items: center;\n    background-color: #f7fff6;\n    padding: 2rem 4rem;\n    border-radius: 1rem;\n"]))),xe=j.a.div(Z||(Z=Object(b.a)(["\n    text-align: left;\n"]))),we=Object(j.a)(u.b)($||($=Object(b.a)(["\n    text-transform: uppercase;\n    font-weight: 700;\n    color: #000;\n"]))),ye=function(){return Object(p.jsx)(Oe,{children:Object(p.jsxs)(fe,{children:[Object(p.jsx)(ee,{children:Object(p.jsx)(u.b,{to:"/blog/article/how-our-team-writes-tests",children:"How our team writes React tests and other stuff too"})}),Object(p.jsx)(ne,{children:Object(p.jsx)("time",{children:"5 June 2021"})}),Object(p.jsxs)(xe,{children:[Object(p.jsx)(se,{children:"Have you ever worked in a codebase where each test file was different to the next? Different terminology and grouping of test scenarios; different usages of snapshot testing and react-testing-library."}),Object(p.jsx)(se,{children:"The effect of this meant wasted time reading a full test file to understand its structure before adding another test case. Creating new tests involved making multiple decisions; should I copy the structure of an existing test or create a new one? Should I use snapshot tests?"}),Object(p.jsx)(se,{children:"We solved this problem by defining guidelines to follow, that make writing tests that are easy to read and write, and would reduced wasted time on decisions."})]}),Object(p.jsx)(we,{to:"/blog/article/how-our-team-writes-tests",children:"Read more"})]})})},ve=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(y.a,{children:[Object(p.jsx)("title",{children:"Home | Robert Prib | Blog "}),Object(p.jsx)("meta",{name:"description",content:"Personal blog of Robert Prib with articles on web development"}),Object(p.jsx)("meta",{name:"og:title",content:"Personal blog of Robert Prib"}),Object(p.jsx)("meta",{name:"og:description",content:"Articles on web development"}),Object(p.jsx)("meta",{name:"og:url",content:"https://whassup.github.io/blog/"})]}),Object(p.jsx)(w,{}),Object(p.jsx)(ye,{})]})},ke=function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(u.a,{children:Object(p.jsxs)(h.c,{children:[Object(p.jsx)(h.a,{exact:!0,path:"/blog/about"}),Object(p.jsx)(h.a,{exact:!0,path:"/blog/article/:article",children:Object(p.jsx)(ge,{})}),Object(p.jsx)(h.a,{exact:!0,strict:!1,path:"/blog",children:Object(p.jsx)(ve,{})})]})})})},Ce=(n(87),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,93)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),s(e),r(e),o(e),i(e)}))}),He=document.getElementById("root");He&&He.hasChildNodes()?Object(d.hydrate)(Object(p.jsx)(ke,{}),He):Object(d.render)(Object(p.jsx)(ke,{}),He),Ce()}},[[88,1,2]]]);
//# sourceMappingURL=main.b79c1c0a.chunk.js.map